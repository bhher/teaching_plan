# 은행 계좌 관리 시스템 연습문제 정답

## Account.java

```java
package a0127.bank;

public class Account {
    private String accountNumber;  // 계좌번호
    private String ownerName;      // 예금주명
    private int balance;           // 잔액
    
    public Account(String accountNumber, String ownerName, int balance) {
        this.accountNumber = accountNumber;
        this.ownerName = ownerName;
        this.balance = balance;
    }
    
    // 파일 저장용 문자열
    public String toFileString() {
        return accountNumber + "|" + ownerName + "|" + balance;
    }
    
    // 파일에서 읽은 문자열로 객체 생성
    public static Account fromFileString(String line) {
        try {
            String[] parts = line.split("\\|");
            if (parts.length == 3) {
                String accountNumber = parts[0].trim();
                String ownerName = parts[1].trim();
                int balance = Integer.parseInt(parts[2].trim());
                return new Account(accountNumber, ownerName, balance);
            }
        } catch (NumberFormatException e) {
            return null;
        }
        return null;
    }
    
    // Getter
    public String getAccountNumber() {
        return accountNumber;
    }
    
    public String getOwnerName() {
        return ownerName;
    }
    
    public int getBalance() {
        return balance;
    }
    
    // Setter (잔액 변경용)
    public void setBalance(int balance) {
        this.balance = balance;
    }
    
    // 입금
    public void deposit(int amount) {
        this.balance += amount;
    }
    
    // 출금 (잔액 체크 포함)
    public boolean withdraw(int amount) {
        if (balance >= amount) {
            this.balance -= amount;
            return true;
        }
        return false;
    }
    
    @Override
    public String toString() {
        return "계좌번호: " + accountNumber + ", 예금주: " + ownerName + ", 잔액: " + balance + "원";
    }
}
```

## AccountManager.java

```java
package a0127.bank;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

public class AccountManager {
    private ArrayList<Account> accounts;
    private String filename;
    
    public AccountManager() {
        this.accounts = new ArrayList<>();
        this.filename = "c:/Users/TJ/memo/account.txt";
    }
    
    // 출력 디렉토리(폴더) 확인 및 생성
    private void ensureDirectory() {
        File file = new File(filename);
        File parentDir = file.getParentFile(); // c:/Users/TJ/memo/
        if (parentDir != null && !parentDir.exists()) { // 폴더가 없으면
            parentDir.mkdirs(); // 폴더를 만들어라
            System.out.println("디렉토리가 생성되었습니다: " + parentDir.getPath());
        }
    }
    
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        AccountManager manager = new AccountManager();
        
        while (true) {
            System.out.println("\n=== 은행 계좌 관리 시스템 ===");
            System.out.println("1. 계좌 생성");
            System.out.println("2. 입금");
            System.out.println("3. 출금");
            System.out.println("4. 계좌 조회");
            System.out.println("5. 전체 계좌 조회");
            System.out.println("6. 계좌 삭제");
            System.out.println("7. 파일 저장");
            System.out.println("8. 파일 불러오기");
            System.out.println("9. 종료");
            System.out.print("선택 > ");
            
            int choice;
            try {
                choice = sc.nextInt();
                sc.nextLine(); // 버퍼 비우기
            } catch (Exception e) {
                System.out.println("숫자만 입력하세요.");
                sc.nextLine(); // 잘못된 입력 제거
                continue;
            }
            
            switch (choice) {
                case 1:
                    System.out.print("계좌번호 입력: ");
                    String accountNumber = sc.nextLine();
                    System.out.print("예금주명 입력: ");
                    String ownerName = sc.nextLine();
                    System.out.print("초기 잔액 입력: ");
                    try {
                        int initialBalance = sc.nextInt();
                        sc.nextLine();
                        manager.createAccount(accountNumber, ownerName, initialBalance);
                    } catch (Exception e) {
                        System.out.println("잔액은 숫자로 입력하세요.");
                        sc.nextLine();
                    }
                    break;
                case 2:
                    System.out.print("계좌번호 입력: ");
                    String depositAccount = sc.nextLine();
                    System.out.print("입금할 금액 입력: ");
                    try {
                        int depositAmount = sc.nextInt();
                        sc.nextLine();
                        manager.deposit(depositAccount, depositAmount);
                    } catch (Exception e) {
                        System.out.println("금액은 숫자로 입력하세요.");
                        sc.nextLine();
                    }
                    break;
                case 3:
                    System.out.print("계좌번호 입력: ");
                    String withdrawAccount = sc.nextLine();
                    System.out.print("출금할 금액 입력: ");
                    try {
                        int withdrawAmount = sc.nextInt();
                        sc.nextLine();
                        manager.withdraw(withdrawAccount, withdrawAmount);
                    } catch (Exception e) {
                        System.out.println("금액은 숫자로 입력하세요.");
                        sc.nextLine();
                    }
                    break;
                case 4:
                    System.out.print("계좌번호 입력: ");
                    String searchAccount = sc.nextLine();
                    manager.findAccount(searchAccount);
                    break;
                case 5:
                    manager.printAll();
                    break;
                case 6:
                    System.out.print("삭제할 계좌번호 입력: ");
                    String deleteAccount = sc.nextLine();
                    manager.deleteAccount(deleteAccount);
                    break;
                case 7:
                    manager.saveToFile();
                    break;
                case 8:
                    manager.loadFromFile();
                    break;
                case 9:
                    System.out.println("프로그램을 종료합니다.");
                    sc.close();
                    return;
                default:
                    System.out.println("1~9번 중에 선택하세요.");
            }
        }
    }
    
    // 계좌 찾기 (계좌번호로)
    private Account findAccountByNumber(String accountNumber) {
        for (Account account : accounts) {
            if (account.getAccountNumber().equals(accountNumber)) {
                return account;
            }
        }
        return null;
    }
    
    // 계좌 생성
    private void createAccount(String accountNumber, String ownerName, int initialBalance) {
        // 계좌번호 중복 체크
        if (findAccountByNumber(accountNumber) != null) {
            System.out.println("이미 존재하는 계좌번호입니다.");
            return;
        }
        
        accounts.add(new Account(accountNumber, ownerName, initialBalance));
        System.out.println("계좌가 생성되었습니다.");
    }
    
    // 입금
    private void deposit(String accountNumber, int amount) {
        Account account = findAccountByNumber(accountNumber);
        if (account != null) {
            account.deposit(amount);
            System.out.println("입금 완료! 현재 잔액: " + account.getBalance() + "원");
            saveToFile(); // 입금 후 자동 저장
        } else {
            System.out.println("계좌를 찾을 수 없습니다.");
        }
    }
    
    // 출금
    private void withdraw(String accountNumber, int amount) {
        Account account = findAccountByNumber(accountNumber);
        if (account != null) {
            if (account.withdraw(amount)) {
                System.out.println("출금 완료! 현재 잔액: " + account.getBalance() + "원");
                saveToFile(); // 출금 후 자동 저장
            } else {
                System.out.println("잔액이 부족합니다. 현재 잔액: " + account.getBalance() + "원");
            }
        } else {
            System.out.println("계좌를 찾을 수 없습니다.");
        }
    }
    
    // 계좌 조회
    private void findAccount(String accountNumber) {
        Account account = findAccountByNumber(accountNumber);
        if (account != null) {
            System.out.println("=== 계좌 정보 ===");
            System.out.println("계좌번호: " + account.getAccountNumber());
            System.out.println("예금주명: " + account.getOwnerName());
            System.out.println("잔액: " + account.getBalance() + "원");
        } else {
            System.out.println("계좌를 찾을 수 없습니다.");
        }
    }
    
    // 전체 계좌 조회
    private void printAll() {
        if (accounts.isEmpty()) {
            System.out.println("등록된 계좌가 없습니다.");
            return;
        }
        System.out.println("=== 전체 계좌 목록 ===");
        for (int i = 0; i < accounts.size(); i++) {
            System.out.println((i + 1) + ". " + accounts.get(i));
        }
    }
    
    // 계좌 삭제
    private void deleteAccount(String accountNumber) {
        Account account = findAccountByNumber(accountNumber);
        if (account != null) {
            accounts.remove(account);
            System.out.println("계좌가 삭제되었습니다.");
            saveToFile(); // 삭제 후 자동 저장
        } else {
            System.out.println("계좌를 찾을 수 없습니다.");
        }
    }
    
    // 파일에서 계좌 정보 읽기
    private void loadFromFile() {
        File file = new File(filename);
        if (!file.exists()) {
            System.out.println("파일이 없습니다. 새로 시작합니다.");
            return;
        }
        
        try (BufferedReader br = new BufferedReader(new FileReader(filename))) {
            String line;
            while ((line = br.readLine()) != null) {
                line = line.trim();
                if (!line.isEmpty()) {
                    Account account = Account.fromFileString(line); // 123-456-789|홍길동|100000
                    if (account != null) {
                        accounts.add(account);
                    }
                }
            }
            System.out.println("파일 불러오기 완료! (" + accounts.size() + "개 계좌)");
        } catch (IOException e) {
            System.out.println("파일 읽기 오류: " + e.getMessage());
        }
    }
    
    // 파일에 계좌 정보 저장
    private void saveToFile() {
        // 디렉토리 확인 및 생성
        ensureDirectory();
        try (BufferedWriter bw = new BufferedWriter(new FileWriter(filename))) {
            for (Account account : accounts) {
                bw.write(account.toFileString());
                bw.newLine(); // 줄바꿈
            }
            System.out.println("파일 저장 완료: " + filename);
        } catch (IOException e) {
            System.out.println("파일 저장 오류: " + e.getMessage());
        }
    }
}
```

## 코드 설명

### Account 클래스

1. **필드**
   - `accountNumber`: 계좌번호 (String)
   - `ownerName`: 예금주명 (String)
   - `balance`: 잔액 (int)

2. **주요 메서드**
   - `toFileString()`: 파일 저장용 문자열 변환 (`계좌번호|예금주명|잔액`)
   - `fromFileString(String line)`: 파일에서 읽은 문자열을 Account 객체로 변환
   - `deposit(int amount)`: 입금 처리
   - `withdraw(int amount)`: 출금 처리 (잔액 부족 시 false 반환)
   - Getter/Setter 메서드들

### AccountManager 클래스

1. **필드**
   - `accounts`: 계좌 목록을 저장하는 ArrayList
   - `filename`: 파일 경로 (`c:/Users/TJ/memo/account.txt`)

2. **주요 메서드**

   **`ensureDirectory()`**
   - 파일의 부모 디렉토리가 없으면 자동 생성
   - StudentManager와 동일한 로직

   **`findAccountByNumber(String accountNumber)`**
   - 계좌번호로 계좌를 찾는 헬퍼 메서드
   - 여러 곳에서 재사용됨

   **`createAccount(String accountNumber, String ownerName, int initialBalance)`**
   - 계좌 생성
   - 계좌번호 중복 체크 포함
   - 중복이면 "이미 존재하는 계좌번호입니다." 메시지 출력

   **`deposit(String accountNumber, int amount)`**
   - 입금 처리
   - 계좌를 찾아서 `account.deposit(amount)` 호출
   - 입금 후 자동으로 파일 저장

   **`withdraw(String accountNumber, int amount)`**
   - 출금 처리
   - 계좌를 찾아서 `account.withdraw(amount)` 호출
   - `withdraw()` 메서드가 false를 반환하면 잔액 부족 메시지 출력
   - 출금 후 자동으로 파일 저장

   **`findAccount(String accountNumber)`**
   - 계좌 조회
   - 계좌번호, 예금주명, 잔액을 출력

   **`printAll()`**
   - 전체 계좌 목록 출력
   - 계좌가 없으면 "등록된 계좌가 없습니다." 메시지 출력

   **`deleteAccount(String accountNumber)`**
   - 계좌 삭제
   - 삭제 후 자동으로 파일 저장

   **`loadFromFile()`**
   - 파일에서 계좌 정보 읽기
   - 파일이 없으면 "파일이 없습니다. 새로 시작합니다." 메시지 출력
   - 각 줄을 `Account.fromFileString()`으로 파싱하여 ArrayList에 추가

   **`saveToFile()`**
   - 현재 메모리의 모든 계좌 정보를 파일에 저장
   - 디렉토리 자동 생성 포함
   - 각 계좌를 `account.toFileString()`으로 변환하여 저장

## 실행 예시

```
=== 은행 계좌 관리 시스템 ===
1. 계좌 생성
2. 입금
3. 출금
4. 계좌 조회
5. 전체 계좌 조회
6. 계좌 삭제
7. 파일 저장
8. 파일 불러오기
9. 종료
선택 > 1
계좌번호 입력: 123-456-789
예금주명 입력: 홍길동
초기 잔액 입력: 100000
계좌가 생성되었습니다.

선택 > 1
계좌번호 입력: 987-654-321
예금주명 입력: 김철수
초기 잔액 입력: 50000
계좌가 생성되었습니다.

선택 > 2
계좌번호 입력: 123-456-789
입금할 금액 입력: 50000
입금 완료! 현재 잔액: 150000원
디렉토리가 생성되었습니다: c:\Users\TJ\memo
파일 저장 완료: c:/Users/TJ/memo/account.txt

선택 > 3
계좌번호 입력: 123-456-789
출금할 금액 입력: 30000
출금 완료! 현재 잔액: 120000원
파일 저장 완료: c:/Users/TJ/memo/account.txt

선택 > 3
계좌번호 입력: 123-456-789
출금할 금액 입력: 200000
잔액이 부족합니다. 현재 잔액: 120000원

선택 > 4
계좌번호 입력: 123-456-789
=== 계좌 정보 ===
계좌번호: 123-456-789
예금주명: 홍길동
잔액: 120000원

선택 > 5
=== 전체 계좌 목록 ===
1. 계좌번호: 123-456-789, 예금주: 홍길동, 잔액: 120000원
2. 계좌번호: 987-654-321, 예금주: 김철수, 잔액: 50000원

선택 > 6
삭제할 계좌번호 입력: 987-654-321
계좌가 삭제되었습니다.
파일 저장 완료: c:/Users/TJ/memo/account.txt

선택 > 8
파일 불러오기 완료! (1개 계좌)

선택 > 9
프로그램을 종료합니다.
```

## 학습 포인트

1. **ArrayList 활용**
   - 동적 배열로 계좌 목록 관리
   - `add()`, `remove()`, `isEmpty()`, `size()` 메서드 활용

2. **파일 입출력**
   - `BufferedReader`/`BufferedWriter` 사용
   - `try-with-resources` 구문으로 자동 리소스 관리
   - 파일 형식: `계좌번호|예금주명|잔액`

3. **객체 지향 설계**
   - Account 클래스: 계좌 데이터와 관련 메서드 캡슐화
   - AccountManager 클래스: 계좌 관리 로직 담당
   - 메서드 분리로 코드 재사용성 향상

4. **예외 처리**
   - 파일 입출력 예외 처리 (`IOException`)
   - 숫자 입력 예외 처리 (`NumberFormatException`, `InputMismatchException`)
   - 사용자 친화적인 오류 메시지

5. **비즈니스 로직**
   - 잔액 부족 체크 (출금 시)
   - 계좌번호 중복 체크 (계좌 생성 시)
   - 자동 파일 저장 (입금/출금/삭제 후)

6. **코드 재사용**
   - `findAccountByNumber()` 메서드로 중복 코드 제거
   - 여러 기능에서 동일한 로직 재사용
